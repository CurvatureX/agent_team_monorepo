{
  "name": "Daily Weather Alert System",
  "description": "每天早上8点获取天气信息，根据天气状况发送不同的提醒",
  "nodes": [
    {
      "id": "trigger_daily",
      "name": "每日触发器",
      "type": "TRIGGER_NODE",
      "subtype": "CRON",
      "parameters": {
        "cron_expression": "0 8 * * *",
        "timezone": "Asia/Shanghai"
      },
      "position": { "x": 100, "y": 100 }
    },
    {
      "id": "fetch_weather",
      "name": "获取天气信息",
      "type": "ACTION_NODE",
      "subtype": "HTTP_REQUEST",
      "parameters": {
        "method": "GET",
        "url": "https://api.openweathermap.org/data/2.5/weather",
        "query_params": {
          "q": "Shanghai",
          "appid": "${WEATHER_API_KEY}",
          "units": "metric"
        },
        "headers": {
          "Accept": "application/json"
        }
      },
      "position": { "x": 300, "y": 100 }
    },
    {
      "id": "check_weather",
      "name": "检查天气状况",
      "type": "FLOW_NODE",
      "subtype": "SWITCH",
      "parameters": {
        "switch_value": "${fetch_weather.output.weather[0].main}",
        "cases": [
          {
            "case": "Rain",
            "output_port": "rain"
          },
          {
            "case": "Clear",
            "output_port": "clear"
          },
          {
            "case": "Clouds",
            "output_port": "cloudy"
          }
        ],
        "default_output_port": "other"
      },
      "position": { "x": 500, "y": 100 }
    },
    {
      "id": "rain_alert",
      "name": "雨天提醒",
      "type": "ACTION_NODE",
      "subtype": "TRANSFORM_DATA",
      "parameters": {
        "transform_script": "return { message: `今天${input.fetch_weather.output.name}有雨，记得带伞！当前温度：${input.fetch_weather.output.main.temp}°C`, weather_type: 'rainy' };"
      },
      "position": { "x": 700, "y": 50 }
    },
    {
      "id": "sunny_alert",
      "name": "晴天提醒",
      "type": "ACTION_NODE",
      "subtype": "TRANSFORM_DATA",
      "parameters": {
        "transform_script": "return { message: `今天${input.fetch_weather.output.name}天气晴朗！当前温度：${input.fetch_weather.output.main.temp}°C，适合户外活动`, weather_type: 'sunny' };"
      },
      "position": { "x": 700, "y": 150 }
    },
    {
      "id": "cloudy_alert",
      "name": "多云提醒",
      "type": "ACTION_NODE",
      "subtype": "TRANSFORM_DATA",
      "parameters": {
        "transform_script": "return { message: `今天${input.fetch_weather.output.name}多云，当前温度：${input.fetch_weather.output.main.temp}°C`, weather_type: 'cloudy' };"
      },
      "position": { "x": 700, "y": 250 }
    },
    {
      "id": "other_alert",
      "name": "其他天气提醒",
      "type": "ACTION_NODE",
      "subtype": "TRANSFORM_DATA",
      "parameters": {
        "transform_script": "return { message: `今天${input.fetch_weather.output.name}天气状况：${input.fetch_weather.output.weather[0].main}，当前温度：${input.fetch_weather.output.main.temp}°C`, weather_type: 'other' };"
      },
      "position": { "x": 700, "y": 350 }
    },
    {
      "id": "merge_alerts",
      "name": "合并提醒信息",
      "type": "FLOW_NODE",
      "subtype": "MERGE",
      "parameters": {
        "merge_strategy": "first_complete"
      },
      "position": { "x": 900, "y": 200 }
    },
    {
      "id": "check_temperature",
      "name": "检查温度",
      "type": "FLOW_NODE",
      "subtype": "IF",
      "parameters": {
        "condition": "${fetch_weather.output.main.temp} < 10 || ${fetch_weather.output.main.temp} > 35"
      },
      "position": { "x": 1100, "y": 200 }
    },
    {
      "id": "add_temp_warning",
      "name": "添加温度警告",
      "type": "ACTION_NODE",
      "subtype": "TRANSFORM_DATA",
      "parameters": {
        "transform_script": "return { ...input.merge_alerts.output, message: input.merge_alerts.output.message + ' ⚠️ 温度异常，请注意防护！', has_warning: true };"
      },
      "position": { "x": 1300, "y": 150 }
    },
    {
      "id": "final_merge",
      "name": "最终合并",
      "type": "FLOW_NODE",
      "subtype": "MERGE",
      "parameters": {
        "merge_strategy": "first_complete"
      },
      "position": { "x": 1500, "y": 200 }
    },
    {
      "id": "send_notification",
      "name": "发送通知",
      "type": "ACTION_NODE",
      "subtype": "HTTP_REQUEST",
      "parameters": {
        "method": "POST",
        "url": "https://api.example.com/notifications",
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer ${NOTIFICATION_API_KEY}"
        },
        "body": {
          "channel": "weather_alerts",
          "message": "${final_merge.output.message}",
          "priority": "${final_merge.output.has_warning ? 'high' : 'normal'}",
          "metadata": {
            "weather_type": "${final_merge.output.weather_type}",
            "temperature": "${fetch_weather.output.main.temp}",
            "city": "${fetch_weather.output.name}"
          }
        }
      },
      "position": { "x": 1700, "y": 200 }
    }
  ],
  "connections": {
    "trigger_daily": {
      "main": [
        {
          "node": "fetch_weather",
          "port": "main"
        }
      ]
    },
    "fetch_weather": {
      "success": [
        {
          "node": "check_weather",
          "port": "main"
        }
      ]
    },
    "check_weather": {
      "rain": [
        {
          "node": "rain_alert",
          "port": "main"
        }
      ],
      "clear": [
        {
          "node": "sunny_alert",
          "port": "main"
        }
      ],
      "cloudy": [
        {
          "node": "cloudy_alert",
          "port": "main"
        }
      ],
      "other": [
        {
          "node": "other_alert",
          "port": "main"
        }
      ]
    },
    "rain_alert": {
      "main": [
        {
          "node": "merge_alerts",
          "port": "input1"
        }
      ]
    },
    "sunny_alert": {
      "main": [
        {
          "node": "merge_alerts",
          "port": "input2"
        }
      ]
    },
    "cloudy_alert": {
      "main": [
        {
          "node": "merge_alerts",
          "port": "input3"
        }
      ]
    },
    "other_alert": {
      "main": [
        {
          "node": "merge_alerts",
          "port": "input4"
        }
      ]
    },
    "merge_alerts": {
      "main": [
        {
          "node": "check_temperature",
          "port": "main"
        }
      ]
    },
    "check_temperature": {
      "true": [
        {
          "node": "add_temp_warning",
          "port": "main"
        }
      ],
      "false": [
        {
          "node": "final_merge",
          "port": "input2"
        }
      ]
    },
    "add_temp_warning": {
      "main": [
        {
          "node": "final_merge",
          "port": "input1"
        }
      ]
    },
    "final_merge": {
      "main": [
        {
          "node": "send_notification",
          "port": "main"
        }
      ]
    }
  },
  "settings": {
    "error_handling": {
      "retry_failed_nodes": true,
      "max_retries": 3,
      "retry_delay": 60
    },
    "execution": {
      "timeout": 300,
      "save_execution_data": true
    }
  },
  "static_data": {
    "WEATHER_API_KEY": "your-openweather-api-key",
    "NOTIFICATION_API_KEY": "your-notification-api-key"
  }
}